<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>Critical Sections</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', '01337.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="01363.html" target="topic">System Service Libraries Help</a> &gt; <a href="00630.html" target="topic">Interrupt System Service Library</a> &gt; <a href="01350.html" target="topic">Using the Library</a> &gt; <a href="01342.html" target="topic">How the Library Works</a> &gt; <a href="01337.html" target="topic">Critical Sections</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony Help Template</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.html" target="tocidx">Contents</a> | <a href="00020.html" target="topic">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="01344.html" target="topic">Previous</a> | <a href="01342.html" target="topic">Up</a> | <a href="01348.html" target="topic">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: SYSTEM INT Critical Sections Topic Title: Critical Sections)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com" target="_blank">Microchip Support</a></div>
</td></tr></table><div class="Element5">
Critical Sections</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<div class="Element15">
Critical Sections</div>
<p class="Element10">
Critical sections of code are small sections of code that must execute atomically, with no possibility of being interrupted. To support this, the following technique can be used.&nbsp;</p>
<p class="Element10">
Global Interrupt Management provides routines to create a global critical section of code.&nbsp;</p>
<p class="Element10">
<strong><u>Global Critical Section</u></strong>&nbsp;</p>
<p class="Element10">
If no interrupts of any kind can be allowed within a critical section of code, the following routines can be used to ensure this.</p>
<ul class="Element630">
<li class="Element600"><a href="01189.html" target="topic">SYS_INT_Disable</a>: To start a critical section, all interrupts are disabled with the call of this function</li>
<li class="Element600"><a href="01191.html" target="topic">SYS_INT_Enable</a> : To end a critical section, interrupts are enabled from the interrupt controller to the core</li>
<li class="Element600"><a href="01192.html" target="topic">SYS_INT_IsEnabled</a>: Status to indicate if whether or interrupts are currently enabled</li>
</ul><p class="Element10">
<strong>Example:</strong> <strong>Global Critical Section</strong> </p><div class="Element13"><div class="Element12"><pre class="Element12"><strong><span style="color: #000080">bool</span></strong> flag;
flag = SYS_INT_Disable();

<i><span style="color: #008000">// Do something critical</span></i>

<strong><span style="color: #000080">if</span></strong> (flag)
{
    SYS_INT_Enable();
}</pre></div></div>
<p class="Element10">
Source Interrupt Management provides interface routines to create local critical sections.&nbsp;</p>
<p class="Element10">
<strong><u>Local Critical Sections</u></strong>&nbsp;</p>
<p class="Element10">
Normally, it is not necessary to globally disable all possible interrupts. For example, in a driver for a specific device, it is not normally important if an unrelated interrupt occurs in the middle of a critical section of code. However, if the interrupt for the source that the driver manages must not occur within a critical section of code, it can be protected using the following technique.&nbsp;</p>
<p class="Element10">
<strong>Example:</strong> <strong>Local Critical Section</strong> &nbsp;</p><div class="Element13"><div class="Element12"><pre class="Element12"><strong><span style="color: #000080">bool</span></strong> flag;
<i><span style="color: #008000">// interrupt source enable status before disable is called</span></i>
flag = SYS_INT_SourceDisable(MY_DRIVER_INTERRUPT_SOURCE);

<i><span style="color: #008000">// Do something critical</span></i>

<strong><span style="color: #000080">if</span></strong> (flag)
{
    SYS_INT_SourceEnable(MY_DRIVER_INTERRUPT_SOURCE);
}
</pre></div></div>
<div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element67" valign="top" width="10%" style="border:none;">
<div class="Element68">
<img src="Note Icon.png" border="0" alt="" title=""> <strong>Note:</strong>&nbsp;</div></td><td class="Element67" valign="top" width="90%" style="border:none;">
<div class="Element68">
These methods of protecting critical sections is usually implemented as part of an Operating System Abstraction Layer (OSAL), so it is not normally necessary to use these examples explicitly. Normally, the OSAL will provide single functions or macros that implement this functionality. So, if available, an OSAL method is preferred over implementing the critical section code as shown in the previous examples.&nbsp;</div></td></tr></table></div></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="01363.html" target="topic">System Service Libraries Help</a> &gt; <a href="00630.html" target="topic">Interrupt System Service Library</a> &gt; <a href="01350.html" target="topic">Using the Library</a> &gt; <a href="01342.html" target="topic">How the Library Works</a> &gt; <a href="01337.html" target="topic">Critical Sections</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element3">
MPLAB Harmony Help Template</div>
</td><td width="25%">
<div class="Element4">
<a href="contents.html" target="tocidx">Contents</a> | <a href="00020.html" target="topic">Home</a></div>
</td><td width="25%">
<div class="Element91">
<a href="01344.html" target="topic">Previous</a> | <a href="01342.html" target="topic">Up</a> | <a href="01348.html" target="topic">Next</a></div>
</td><td width="25%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: SYSTEM INT Critical Sections Topic Title: Critical Sections)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com" target="_blank">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>